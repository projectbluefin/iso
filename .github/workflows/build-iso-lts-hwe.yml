---
name: Build LTS-HWE ISOs
# This workflow ONLY builds LTS-HWE ISOs (not GTS, Stable, or LTS)
# Builds: 2 LTS-HWE ISOs
#   - amd64 × main
#   - arm64 × main
on:
  workflow_dispatch:
    inputs:
      image_tag:
        description: 'Image tag to build from'
        type: string
        default: lts
      upload_artifacts:
        description: 'Upload ISOs as job artifacts'
        type: boolean
        default: false
      upload_r2:
        description: 'Upload ISOs to Cloudflare R2'
        type: boolean
        default: true
      enable_dakota:
        description: 'Enable Dakota'
        type: boolean
        default: false
  schedule:
    - cron: '0 2 1 * *'  # 2am UTC on the 1st of every month

jobs:
  build-iso-lts-hwe:
    name: Build LTS-HWE ISOs
    uses: ./.github/workflows/reusable-build-iso-anaconda.yml
    secrets: inherit
    with:
      image_version: lts-hwe  # Strictly builds LTS-HWE ISOs only
      image_tag: ${{ github.event_name == 'workflow_dispatch' && inputs.image_tag || 'lts' }}
      upload_artifacts: ${{ github.event_name == 'workflow_dispatch' && inputs.upload_artifacts || false }}
      upload_r2: ${{ github.event_name == 'workflow_dispatch' && inputs.upload_r2 || true }}
      enable_dakota: ${{ github.event_name == 'workflow_dispatch' && inputs.enable_dakota || false }}
